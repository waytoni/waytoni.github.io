<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=GT-MBNDJTD">
  </script>
  <script>
   window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'GT-MBNDJTD');
  </script>
  <link href="/favicon.ico" rel="icon" type="image/x-icon"/>
  <link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
  <link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
  <link href="/site.webmanifest" rel="manifest"/>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>චිත්ත සහ චෛතසික චක්‍රය with Zoom</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a3a 0%, #0d1824 100%);
            color: #f0f0f0;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            width: 100%;
            max-width: 1800px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        header {
            text-align: center;
            padding: 25px;
            background: rgba(0, 20, 40, 0.8);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            margin-bottom: 10px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 12px;
            background: linear-gradient(to right, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #a0d2ff;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.5;
        }
        
        .top-controls {
            background: rgba(0, 15, 30, 0.95);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 15px;
        }
        
        .control-group {
            min-width: 300px;
        }
        
        .control-title {
            font-size: 1.3rem;
            color: #4facfe;
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(79, 172, 254, 0.3);
        }
        
        .control-title i {
            font-size: 1.5rem;
        }
        
        .zoom-controls, .navigation-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 18px;
        }
        
        .nav-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 18px;
        }
        
        button {
            background: linear-gradient(to bottom, #2a5a8a, #1a3a5a);
            color: white;
            border: none;
            padding: 16px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        button:hover {
            background: linear-gradient(to bottom, #3a6a9a, #2a4a6a);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button i {
            font-size: 1.2rem;
        }
        
        .slider-container {
            margin: 20px 0;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        
        .slider-label span {
            font-weight: 600;
            color: #a0d2ff;
        }
        
        .zoom-level {
            font-weight: bold;
            color: #4facfe;
            font-size: 1.4rem;
        }
        
        input[type="range"] {
            width: 100%;
            height: 12px;
            -webkit-appearance: none;
            background: linear-gradient(to right, #1a3a5a, #4facfe);
            border-radius: 6px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #4facfe;
            cursor: pointer;
            box-shadow: 0 0 12px rgba(79, 172, 254, 0.9);
            border: 2px solid #fff;
        }
        
        .zoom-presets {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .zoom-preset {
            padding: 12px;
            background: rgba(79, 172, 254, 0.2);
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
        }
        
        .zoom-preset:hover {
            background: rgba(79, 172, 254, 0.4);
            transform: translateY(-2px);
        }
        
        .zoom-preset.active {
            background: rgba(79, 172, 254, 0.8);
            box-shadow: 0 0 10px rgba(79, 172, 254, 0.5);
        }
        
        .viewer-container {
            flex: 1;
            background: rgba(0, 15, 30, 0.9);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            display: flex;
            flex-direction: column;
            /* Large canvas height relative to viewport */
            height: 70vh;
            min-height: 600px;
            max-height: 800px;
        }
        
        .viewer-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #4facfe;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(79, 172, 254, 0.3);
        }
        
        #image-container {
            flex: 1;
            overflow: auto;
            border: 2px solid rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            position: relative;
            background: #050f1a;
            width: 100%;
        }
        
        #image-display {
            display: block;
            transition: transform 0.3s ease;
            transform-origin: 0 0;
            cursor: grab;
            max-width: none;
        }
        
        #image-display:active {
            cursor: grabbing;
        }
        
        .scroll-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 20, 40, 0.7);
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .scroll-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .scroll-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(0, 30, 60, 0.5);
            border-radius: 6px;
        }
        
        .scroll-label {
            color: #a0d2ff;
            font-weight: 600;
        }
        
        .scroll-value {
            color: #4facfe;
            font-weight: bold;
            font-size: 1.1rem;
            font-family: 'Courier New', monospace;
        }
        
        .reset-btn {
            background: linear-gradient(to bottom, #8a2a2a, #5a1a1a);
        }
        
        .reset-btn:hover {
            background: linear-gradient(to bottom, #9a3a3a, #6a2a2a);
        }
        
        .canvas-size-control {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 30, 60, 0.5);
            border-radius: 8px;
        }
        
        .canvas-size-control label {
            font-weight: 600;
            color: #a0d2ff;
            white-space: nowrap;
        }
        
        .canvas-size-control input {
            width: 100px;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #4facfe;
            background: rgba(0, 20, 40, 0.8);
            color: white;
            text-align: center;
            font-size: 1rem;
        }
        
        .canvas-size-control button {
            min-width: 100px;
            padding: 10px 15px;
            margin: 0;
        }
        
        .instructions {
            background: rgba(0, 15, 30, 0.9);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            margin-top: 20px;
        }
        
        .instructions h3 {
            color: #4facfe;
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .instructions-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .instruction-group {
            padding: 20px;
            background: rgba(0, 20, 40, 0.5);
            border-radius: 8px;
        }
        
        .instructions ul {
            padding-left: 20px;
            line-height: 1.6;
        }
        
        .instructions li {
            margin-bottom: 12px;
        }
        
        .instructions strong {
            color: #a0d2ff;
        }
        
        .image-info {
            margin-top: 20px;
            text-align: center;
            color: #a0d2ff;
            font-style: italic;
            padding: 15px;
            background: rgba(0, 20, 40, 0.5);
            border-radius: 8px;
        }
        
        @media (max-width: 1200px) {
            .top-controls {
                grid-template-columns: 1fr;
            }
            
            .viewer-container {
                height: 65vh;
                min-height: 500px;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .zoom-presets {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .viewer-container {
                height: 60vh;
                min-height: 400px;
                padding: 15px;
            }
            
            .top-controls {
                padding: 20px;
                gap: 20px;
            }
            
            .control-group {
                min-width: auto;
            }
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: rgba(0, 30, 60, 0.8);
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 15px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #4caf50;
        }
        
        .navigation-info {
            color: #ffa726;
            font-size: 0.9rem;
            margin-top: 8px;
            font-style: italic;
        }
        
        .canvas-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: rgba(79, 172, 254, 0.1);
            border-radius: 6px;
            margin-bottom: 15px;
        }
        
        .canvas-dimensions {
            font-family: 'Courier New', monospace;
            color: #4facfe;
            font-weight: bold;
        }
        
        .aspect-ratio {
            color: #a0d2ff;
            font-style: italic;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h3>ගරු අජන්තා සම්පත් ගුරුතුමා විසින් සකස් කරන ලද </h3>
            <h1> චිත්ත සහ චෛතසික චක්‍රය</h1>
            <!--p class="subtitle">Optimized for high-resolution images (9600×6387) with spacious canvas and smooth navigation</p-->
        </header>
        
        <div class="top-controls">
            <div class="control-group">
                <h3 class="control-title"><i class="fas fa-search"></i> Zoom Controls</h3>
                <div class="zoom-controls">
                    <button id="zoom-in">
                        <i class="fas fa-search-plus"></i> Zoom In
                    </button>
                    <button id="zoom-out">
                        <i class="fas fa-search-minus"></i> Zoom Out
                    </button>
                    <button id="zoom-reset" class="reset-btn">
                        <i class="fas fa-sync-alt"></i> Reset
                    </button>
                </div>
                
                <div class="slider-container">
                    <div class="slider-label">
                        <span>Zoom Level</span>
                        <span id="zoom-percent" class="zoom-level">Fit to Width</span>
                    </div>
                    <input type="range" id="zoom-slider" min="1" max="800" value="100" step="5">
                </div>
                
                <div class="zoom-presets">
                    <div class="zoom-preset" data-zoom="10">10%</div>
                    <div class="zoom-preset" data-zoom="25">25%</div>
                    <div class="zoom-preset" data-zoom="50">50%</div>
                    <div class="zoom-preset" data-zoom="100">100%</div>
                    <div class="zoom-preset" data-zoom="200">200%</div>
                    <div class="zoom-preset" data-zoom="400">400%</div>
                </div>
            </div>
            
            <div class="control-group">
                <h3 class="control-title"><i class="fas fa-arrows-alt"></i> Navigation & Canvas</h3>
                
                <div class="canvas-info">
                    <div class="canvas-dimensions" id="canvas-size-display">Canvas: 1707×409px</div>
                    <div class="aspect-ratio">Original: 9600×6387px</div>
                </div>
                
                <div class="nav-buttons">
                    <button id="move-up">
                        <i class="fas fa-arrow-up"></i> Up
                    </button>
                    <button id="move-down">
                        <i class="fas fa-arrow-down"></i> Down
                    </button>
                    <button id="move-left">
                        <i class="fas fa-arrow-left"></i> Left
                    </button>
                    <button id="move-right">
                        <i class="fas fa-arrow-right"></i> Right
                    </button>
                </div>
                
                <div class="canvas-size-control">
                    <label for="canvas-height">Canvas Height:</label>
                    <input type="number" id="canvas-height" value="600" min="300" max="1200" step="50">
                    <span>pixels</span>
                    <button id="apply-canvas-height">
                        <i class="fas fa-check"></i> Apply
                    </button>
                    <span>pixels</span>
                    <button id="center-image" class="reset-btn" style="margin-top: 15px;">
                    <i class="fas fa-crosshairs"></i> Center Image
                </button>
                </div>
           <!--    
                <button id="center-image" class="reset-btn" style="margin-top: 15px;">
                    <i class="fas fa-crosshairs"></i> Center Image
                </button>
            
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span>Large Canvas Mode (70vh height)</span>
                </div>
            -->
            </div>
        </div>
        
        <div class="viewer-container">
            <!--h2 class="viewer-title">Image Viewer - High Resolution Display</h2-->
            <div id="image-container">
                <img id="image-display" src="https://waytoni.com/ChiththaChithasika/LowResoChart%20-%20Ajantha%20Sampath%20Guruthuma.jpg" alt="High resolution landscape chart">
            </div>
            
            <div class="scroll-status">
                <div class="scroll-info">
                    <div class="scroll-item">
                        <span class="scroll-label">Scroll X:</span>
                        <span id="scroll-x" class="scroll-value">0px</span>
                    </div>
                    <div class="scroll-item">
                        <span class="scroll-label">Scroll Y:</span>
                        <span id="scroll-y" class="scroll-value">0px</span>
                    </div>
                </div>
                
                <div class="scroll-info">
                    <div class="scroll-item">
                        <span class="scroll-label">Zoom:</span>
                        <span id="zoom-value" class="scroll-value">Fit to Width</span>
                    </div>
                    <div class="scroll-item">
                        <span class="scroll-label">Position:</span>
                        <span id="position-value" class="scroll-value">0, 0</span>
                    </div>
                </div>
                
                <div class="scroll-info">
                    <div class="scroll-item">
                        <span class="scroll-label">Display Size:</span>
                        <span id="image-size" class="scroll-value">Loading...</span>
                    </div>
                    <div class="scroll-item">
                        <span class="scroll-label">Viewport:</span>
                        <span id="viewport-size" class="scroll-value">Calculating...</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> Navigation Guide</h3>
            <div class="instructions-content">
                <div class="instruction-group">
                    <h4><i class="fas fa-mouse-pointer"></i> Mouse & Touch Controls</h4>
                    <ul>
                        <li><strong>Drag to Pan:</strong> Click and drag anywhere on the image</li>
                        <li><strong>Zoom with Scroll:</strong> Hold <strong>Ctrl/Cmd</strong> and scroll</li>
                        <li><strong>Scrollbars:</strong> Use horizontal/vertical scrollbars</li>
                        <li><strong>Double Click:</strong> Zoom in at cursor position</li>
                    </ul>
                </div>
                
                <div class="instruction-group">
                    <h4><i class="fas fa-expand-alt"></i> Canvas Settings</h4>
                    <ul>
                        <li><strong>Canvas Height:</strong> Adjust to 600-1200 pixels</li>
                        <li><strong>Auto Fit:</strong> Image fits canvas width initially</li>
                        <li><strong>Large Display:</strong> Canvas is 70% of viewport height</li>
                        <li><strong>Responsive:</strong> Adapts to screen size</li>
                    </ul>
                </div>
                
                <div class="instruction-group">
                    <h4><i class="fas fa-keyboard"></i> Keyboard Shortcuts</h4>
                    <ul>
                        <li><strong>Arrow Keys:</strong> Navigate in all directions</li>
                        <li><strong>Ctrl/Cmd + Plus:</strong> Zoom in</li>
                        <li><strong>Ctrl/Cmd + Minus:</strong> Zoom out</li>
                        <li><strong>Ctrl/Cmd + 0:</strong> Reset to fit width</li>
                        <li><strong>Space:</strong> Center image</li>
                        <li><strong>Home:</strong> Scroll to top-left</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!--div class="image-info">
            <p><i class="fas fa-image"></i> Loading high-resolution image (9600×6387). Canvas optimized for detailed viewing.</p>
        </div-->
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get DOM elements
            const imageDisplay = document.getElementById('image-display');
            const imageContainer = document.getElementById('image-container');
            const zoomInBtn = document.getElementById('zoom-in');
            const zoomOutBtn = document.getElementById('zoom-out');
            const zoomResetBtn = document.getElementById('zoom-reset');
            const zoomSlider = document.getElementById('zoom-slider');
            const zoomPercent = document.getElementById('zoom-percent');
            const zoomValue = document.getElementById('zoom-value');
            const moveUpBtn = document.getElementById('move-up');
            const moveDownBtn = document.getElementById('move-down');
            const moveLeftBtn = document.getElementById('move-left');
            const moveRightBtn = document.getElementById('move-right');
            const centerImageBtn = document.getElementById('center-image');
            const scrollX = document.getElementById('scroll-x');
            const scrollY = document.getElementById('scroll-y');
            const positionValue = document.getElementById('position-value');
            const imageSize = document.getElementById('image-size');
            const viewportSize = document.getElementById('viewport-size');
            const zoomPresets = document.querySelectorAll('.zoom-preset');
            const canvasHeightInput = document.getElementById('canvas-height');
            const applyCanvasHeightBtn = document.getElementById('apply-canvas-height');
            const viewerContainer = document.querySelector('.viewer-container');
            const canvasSizeDisplay = document.getElementById('canvas-size-display');
            
            // Initialize variables
            let scale = 1;
            let isDragging = false;
            let startX, startY, scrollLeft, scrollTop;
            const minScale = 0.01;   // 1% minimum zoom
            const maxScale = 8.0;    // 800% maximum zoom
            const scaleStep = 0.05;  // 5% step for buttons
            // Canvas height in pixels (not percentage)
            let canvasHeight = 600;  // Default height in pixels
            
            // Update canvas size display
            function updateCanvasSizeDisplay() {
                const containerWidth = imageContainer.clientWidth;
                const containerHeight = imageContainer.clientHeight;
                canvasSizeDisplay.textContent = `Canvas: ${containerWidth}×${containerHeight}px`;
                viewportSize.textContent = `${containerWidth}×${containerHeight}px`;
                canvasHeightInput.value = canvasHeight;
            }
            
            // Update zoom display
            function updateZoomDisplay() {
                const percent = Math.round(scale * 100);
                zoomPercent.textContent = `${percent}%`;
                zoomValue.textContent = `${percent}%`;
                zoomSlider.value = percent;
                
                // Update active zoom preset
                zoomPresets.forEach(preset => {
                    const presetValue = parseInt(preset.getAttribute('data-zoom'));
                    if (Math.abs(percent - presetValue) < 5) {
                        preset.classList.add('active');
                    } else {
                        preset.classList.remove('active');
                    }
                });
            }
            
            // Update image size display
            function updateImageSizeDisplay() {
                const naturalWidth = imageDisplay.naturalWidth;
                const naturalHeight = imageDisplay.naturalHeight;
                const displayedWidth = Math.round(naturalWidth * scale);
                const displayedHeight = Math.round(naturalHeight * scale);
                
                imageSize.textContent = `${displayedWidth}×${displayedHeight}px`;
            }
            
            // Update scroll position display
            function updateScrollDisplay() {
                scrollX.textContent = `${imageContainer.scrollLeft}px`;
                scrollY.textContent = `${imageContainer.scrollTop}px`;
                
                // Calculate image position relative to container
                const imgRect = imageDisplay.getBoundingClientRect();
                const containerRect = imageContainer.getBoundingClientRect();
                const relativeX = Math.round(imgRect.left - containerRect.left);
                const relativeY = Math.round(imgRect.top - containerRect.top);
                positionValue.textContent = `${relativeX}, ${relativeY}`;
            }
            
            // Apply zoom transformation
            function applyZoom() {
                imageDisplay.style.transform = `scale(${scale})`;
                updateZoomDisplay();
                updateImageSizeDisplay();
                updateScrollDisplay();
            }
            
            // Zoom in function
            function zoomIn() {
                if (scale < maxScale) {
                    const dynamicStep = scale < 1 ? scaleStep * 2 : scaleStep;
                    scale = Math.min(scale + dynamicStep, maxScale);
                    applyZoom();
                }
            }
            
            // Zoom out function
            function zoomOut() {
                if (scale > minScale) {
                    scale = Math.max(scale - scaleStep, minScale);
                    applyZoom();
                }
            }
            
            // Zoom to fit canvas width
            function zoomToFitWidth() {
                const containerWidth = imageContainer.clientWidth;
                const imageWidth = imageDisplay.naturalWidth;
                
                if (containerWidth > 0 && imageWidth > 0) {
                    scale = containerWidth / imageWidth;
                    applyZoom();
                    centerImage();
                }
            }
            
            // Center image in container
            function centerImage() {
                const imgWidth = imageDisplay.naturalWidth * scale;
                const imgHeight = imageDisplay.naturalHeight * scale;
                const containerWidth = imageContainer.clientWidth;
                const containerHeight = imageContainer.clientHeight;
                
                // Calculate scroll positions
                let scrollLeftPos = (imgWidth - containerWidth) / 2;
                let scrollTopPos = (imgHeight - containerHeight) / 2;
                
                // Ensure scroll positions are within bounds
                scrollLeftPos = Math.max(0, scrollLeftPos);
                scrollTopPos = Math.max(0, scrollTopPos);
                
                // Apply scroll positions
                imageContainer.scrollLeft = scrollLeftPos;
                imageContainer.scrollTop = scrollTopPos;
                
                updateScrollDisplay();
            }
            
            // Move image in specified direction
            function moveImage(direction) {
                // Base movement amount
                let moveAmount = 80;
                
                // Adjust movement based on zoom level
                if (scale < 0.3) {
                    moveAmount = 150; // Move faster when very zoomed out
                } else if (scale > 2) {
                    moveAmount = 30; // Move slower when very zoomed in
                }
                
                // Calculate max scroll positions
                const imgWidth = imageDisplay.naturalWidth * scale;
                const imgHeight = imageDisplay.naturalHeight * scale;
                const maxScrollLeft = Math.max(0, imgWidth - imageContainer.clientWidth);
                const maxScrollTop = Math.max(0, imgHeight - imageContainer.clientHeight);
                
                switch(direction) {
                    case 'up':
                        imageContainer.scrollTop = Math.max(0, imageContainer.scrollTop - moveAmount);
                        break;
                    case 'down':
                        imageContainer.scrollTop = Math.min(maxScrollTop, imageContainer.scrollTop + moveAmount);
                        break;
                    case 'left':
                        imageContainer.scrollLeft = Math.max(0, imageContainer.scrollLeft - moveAmount);
                        break;
                    case 'right':
                        imageContainer.scrollLeft = Math.min(maxScrollLeft, imageContainer.scrollLeft + moveAmount);
                        break;
                }
                updateScrollDisplay();
            }
            
            // Set canvas height
            function setCanvasHeight() {
                // Clamp height between 300 and 1200 pixels
                canvasHeight = Math.max(300, Math.min(canvasHeight, 1200));
                
                // Set viewer container height
                viewerContainer.style.height = `${canvasHeight}px`;
                
                // Update input field
                canvasHeightInput.value = canvasHeight;
                
                // Update canvas size display after resize
                setTimeout(() => {
                    updateCanvasSizeDisplay();
                    zoomToFitWidth();
                }, 100);
            }
            
            // Apply custom canvas height
            function applyCustomCanvasHeight() {
                const newHeight = parseInt(canvasHeightInput.value);
                if (newHeight >= 300 && newHeight <= 1200) {
                    canvasHeight = newHeight;
                    setCanvasHeight();
                } else {
                    alert('Please enter a value between 300 and 1200 pixels');
                    canvasHeightInput.value = canvasHeight;
                }
            }
            
            // Initialize the viewer
            function initViewer() {
                // Set initial display text
                zoomPercent.textContent = 'Fit to Width';
                zoomValue.textContent = 'Fit to Width';
                
                // Set initial canvas height
                setCanvasHeight();
                
                // Wait for image to load
                if (imageDisplay.complete) {
                    setupViewer();
                } else {
                    imageDisplay.addEventListener('load', setupViewer);
                }
                
                function setupViewer() {
                    console.log('Image loaded:', imageDisplay.naturalWidth, '×', imageDisplay.naturalHeight);
                    
                    // Initial zoom to fit width
                    setTimeout(() => {
                        zoomToFitWidth();
                        updateCanvasSizeDisplay();
                        updateImageSizeDisplay();
                    }, 300);
                    
                    // Add event listeners for zoom buttons
                    zoomInBtn.addEventListener('click', zoomIn);
                    zoomOutBtn.addEventListener('click', zoomOut);
                    zoomResetBtn.addEventListener('click', zoomToFitWidth);
                    
                    // Add event listener for zoom slider
                    zoomSlider.addEventListener('input', function() {
                        scale = this.value / 100;
                        applyZoom();
                    });
                    
                    // Add event listeners for zoom presets
                    zoomPresets.forEach(preset => {
                        preset.addEventListener('click', function() {
                            scale = parseInt(this.getAttribute('data-zoom')) / 100;
                            applyZoom();
                        });
                    });
                    
                    // Add event listeners for navigation buttons
                    moveUpBtn.addEventListener('click', () => moveImage('up'));
                    moveDownBtn.addEventListener('click', () => moveImage('down'));
                    moveLeftBtn.addEventListener('click', () => moveImage('left'));
                    moveRightBtn.addEventListener('click', () => moveImage('right'));
                    centerImageBtn.addEventListener('click', centerImage);
                    
                    // Apply canvas height button
                    applyCanvasHeightBtn.addEventListener('click', applyCustomCanvasHeight);
                    canvasHeightInput.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            applyCustomCanvasHeight();
                        }
                    });
                    
                    // Mouse wheel zoom with Ctrl key
                    imageContainer.addEventListener('wheel', function(e) {
                        if (e.ctrlKey || e.metaKey) {
                            e.preventDefault();
                            
                            if (e.deltaY < 0) {
                                zoomIn();
                            } else {
                                zoomOut();
                            }
                        }
                    }, { passive: false });
                    
                    // Double click to zoom in
                    imageDisplay.addEventListener('dblclick', function(e) {
                        e.preventDefault();
                        const rect = imageContainer.getBoundingClientRect();
                        const x = e.clientX - rect.left + imageContainer.scrollLeft;
                        const y = e.clientY - rect.top + imageContainer.scrollTop;
                        
                        // Zoom in
                        zoomIn();
                        
                        // Scroll to keep the clicked point in view
                        setTimeout(() => {
                            imageContainer.scrollLeft = x * (scale / (scale - scaleStep)) - rect.width / 2;
                            imageContainer.scrollTop = y * (scale / (scale - scaleStep)) - rect.height / 2;
                            updateScrollDisplay();
                        }, 10);
                    });
                    
                    // Mouse drag to pan
                    imageDisplay.addEventListener('mousedown', function(e) {
                        isDragging = true;
                        startX = e.pageX - imageContainer.getBoundingClientRect().left + imageContainer.scrollLeft;
                        startY = e.pageY - imageContainer.getBoundingClientRect().top + imageContainer.scrollTop;
                        scrollLeft = imageContainer.scrollLeft;
                        scrollTop = imageContainer.scrollTop;
                        imageDisplay.style.cursor = 'grabbing';
                    });
                    
                    document.addEventListener('mousemove', function(e) {
                        if (!isDragging) return;
                        e.preventDefault();
                        
                        const containerRect = imageContainer.getBoundingClientRect();
                        const x = e.pageX - containerRect.left + imageContainer.scrollLeft;
                        const y = e.pageY - containerRect.top + imageContainer.scrollTop;
                        
                        const walkX = (x - startX);
                        const walkY = (y - startY);
                        
                        imageContainer.scrollLeft = scrollLeft - walkX;
                        imageContainer.scrollTop = scrollTop - walkY;
                        
                        updateScrollDisplay();
                    });
                    
                    document.addEventListener('mouseup', function() {
                        isDragging = false;
                        imageDisplay.style.cursor = 'grab';
                    });
                    
                    // Keyboard shortcuts
                    document.addEventListener('keydown', function(e) {
                        // Only process if not in an input field
                        if (e.target.tagName === 'INPUT') return;
                        
                        switch(e.key) {
                            case 'ArrowUp':
                                e.preventDefault();
                                moveImage('up');
                                break;
                            case 'ArrowDown':
                                e.preventDefault();
                                moveImage('down');
                                break;
                            case 'ArrowLeft':
                                e.preventDefault();
                                moveImage('left');
                                break;
                            case 'ArrowRight':
                                e.preventDefault();
                                moveImage('right');
                                break;
                            case '+':
                            case '=':
                                if (e.ctrlKey || e.metaKey) {
                                    e.preventDefault();
                                    zoomIn();
                                }
                                break;
                            case '-':
                                if (e.ctrlKey || e.metaKey) {
                                    e.preventDefault();
                                    zoomOut();
                                }
                                break;
                            case '0':
                                if (e.ctrlKey || e.metaKey) {
                                    e.preventDefault();
                                    zoomToFitWidth();
                                }
                                break;
                            case ' ':
                                e.preventDefault();
                                centerImage();
                                break;
                            case 'Home':
                                e.preventDefault();
                                imageContainer.scrollLeft = 0;
                                imageContainer.scrollTop = 0;
                                updateScrollDisplay();
                                break;
                        }
                    });
                    
                    // Update displays when scrolling
                    imageContainer.addEventListener('scroll', updateScrollDisplay);
                    
                    // Handle window resize
                    let resizeTimeout;
                    window.addEventListener('resize', function() {
                        clearTimeout(resizeTimeout);
                        resizeTimeout = setTimeout(() => {
                            updateCanvasSizeDisplay();
                            updateImageSizeDisplay();
                            updateScrollDisplay();
                        }, 250);
                    });
                    
                    // Update displays periodically
                    setInterval(() => {
                        updateCanvasSizeDisplay();
                        updateImageSizeDisplay();
                    }, 2000);
                }
            }
            
            // Initialize the viewer
            initViewer();
        });
    </script>
</body>
</html>